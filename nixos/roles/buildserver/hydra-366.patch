From a184c8729bc0e2bc55e5cf4ba6e86db165fc95bc Mon Sep 17 00:00:00 2001
From: Dusty DeWeese <dustin.deweese@gmail.com>
Date: Fri, 28 Aug 2020 12:53:27 -0700
Subject: [PATCH] fix suggested in https://github.com/NixOS/hydra/issues/366

---
 src/hydra-queue-runner/queue-monitor.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/hydra-queue-runner/queue-monitor.cc b/src/hydra-queue-runner/queue-monitor.cc
index 57efdcb4c..a8fc49c6c 100644
--- a/src/hydra-queue-runner/queue-monitor.cc
+++ b/src/hydra-queue-runner/queue-monitor.cc
@@ -41,7 +41,7 @@ void State::queueMonitorLoop()
         /* Sleep until we get notification from the database about an
            event. */
         if (done && !quit) {
-            conn->await_notification();
+            conn->await_notification(5*60, 0);
             nrQueueWakeups++;
         } else
             conn->get_notifs();
